#!/bin/bash

ansi_art='â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â£€â£€â£¤â €â €â €â €â €â €â €â €â €[1;34mâ£ â €â €â£ â¡€â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €[0m
â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â£¿â£¿â£¿â €â €â €â €â €â €â €â €â €[1;34mâ£¿â €â €â »â â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €[0m
â €â €â£ â£¶â£¶â£¦â£¶â£¦â£„â €â €â£¦â£¶â¡†â£ â£´â£¶â¡—â €â£ â£´â£¶â£¶â£¦â£¤â €â €â£¿â£¿â¡¿â£¤â£¤â£¤â£¤â£„â¡€â €â €â €[1;34mâ£¿â €â €â£°â €â €â£ â¡€â €â£ â£¤â£¤â£„â €â €â €â£ â¡„â €â €â €â €â €â¢ â¡„â €â£ â¡€â €â €â €â €â£€â €â €[0m
â €â£°â¡¿â ¿â Ÿâ ¿â¢¿â£¿â£¿â¡„â €â£½â£¿â£¿â£¿â£¿â Ÿâ €â£¼â£¿â£¿â£¿â£¿â£¿â£¿â£¿â €â£¿â£¿â£¿â£¿â£¿â¡¿â£¿â£¿â£¿â£‡â €â €[1;34mâ£¿â €â €â£¿â €â €â£¿â£§â¡¶â ›â ›â ›â ¿â£§â¡€â €â£¿â¡‡â €â €â €â €â €â¢¸â¡‡â €â »â£§â €â €â €â£ â£¿â ƒâ €[0m
â €â£°â£¶â£¿â£¿â£·â£¶â£¼â£¿â¡‡â €â¢¿â£¿â¡¿â â €â €â£¾â£¿â¡Ÿâ â €â €â ˆâ ›â â €â£¿â£¿â£¿â €â €â €â €â¢»â£¿â£¿â €â €[1;34mâ£¿â €â €â£¿â €â €â£¿â¡â €â €â €â €â €â£¿â¡‡â €â£¿â¡‡â €â €â €â €â €â¢¸â¡‡â €â €â ™â¢·â£„â£¼â¡¿â â €â €[0m
â£¿â£¿â¡¿â ‹â ‰â ‰â¢»â£¿â£¿â¡‡â €â¢¿â£¿â£—â €â €â €â¢»â£¿â¡„â €â €â €â €â €â €â €â£¿â£¿â£¿â €â €â €â €â£¿â£¿â£¿â €â €[1;34mâ£¿â €â €â£¿â €â €â£¿â¡‡â €â €â €â €â €â£¿â¡‡â €â£¿â¡‡â €â €â €â €â €â¢¸â¡‡â €â €â €â €â£¿â£¯â €â €â €â €[0m
â¢¿â£¿â£·â£€â£€â£€â£¼â£¿â£¿â¡‡â €â£¾â£¿â£¯â €â €â €â¢¿â£¿â£·â£„â£€â£€â£€â£´â£†â €â£¿â£¿â£¿â €â €â €â €â¢½â£¿â£¿â €â €[1;34mâ£¿â €â €â£¿â €â €â£¿â¡‡â €â €â €â €â €â£¿â¡‡â €â£¿â¡‡â €â €â €â €â €â£¾â¡‡â €â €â£´â¡¿â ƒâ ™â£·â¡€â €â €[0m
â €â »â£¿â£¿â£¿â£¿â¡¿â£«â£¿â¡‡â €â£¿â£¿â¡·â €â €â €â €â »â¢¿â£¿â£¿â£¿â£¿â¡¿â ‹â €â£¿â£¿â£¿â €â €â €â €â£»â£¿â£¿â €â €[1;34mâ£¿â €â €â£¿â €â €â£¿â¡‡â €â €â €â €â €â£¿â¡‡â €â ™â£¿â£¦â£¤â£¤â£´â Ÿâ¢¹â¡‡â €â£¼â¡â €â €â €â €â¢¿â¡†â €[0m'

clear
echo -e "\n$ansi_art\n"

sudo pacman -Sy --noconfirm --needed git

# Use custom repo if specified, otherwise default to basecamp/omarchy
OMARCHY_REPO="${OMARCHY_REPO:-pinionless/pinarchy}"

echo -e "\nCloning Omarchy from: https://github.com/${OMARCHY_REPO}.git"
rm -rf ~/.local/share/omarchy/
git clone "https://github.com/${OMARCHY_REPO}.git" ~/.local/share/omarchy >/dev/null

# Use custom branch if instructed, otherwise default to main
OMARCHY_REF="${OMARCHY_REF:-main}"
if [[ $OMARCHY_REF != "main" ]]; then
  echo -e "\eUsing branch: $OMARCHY_REF"
  cd ~/.local/share/omarchy
  git fetch origin "${OMARCHY_REF}" && git checkout "${OMARCHY_REF}"
  cd -
fi

echo -e "\nInstallation starting..."
source ~/.local/share/omarchy/install.sh
